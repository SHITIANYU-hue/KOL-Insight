<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@{kol_name} - ä¸“ä¸šåˆ†ææŠ¥å‘Š</title>
    <style>
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6; margin: 0; padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; color: #333;
        }
        .container {
            max-width: 1800px; margin: 0 auto; background: white;
            border-radius: 20px; box-shadow: 0 15px 50px rgba(0,0,0,0.25);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; padding: 50px; text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        /* KOLèƒŒæ™¯å›¾ */
        .header-background {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-size: cover;
            background-position: center;
            opacity: 0.3;
            filter: blur(3px);
            z-index: 0;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        .back-btn {
            position: absolute; top: 20px; left: 20px;
            background: rgba(255,255,255,0.2); color: white;
            padding: 10px 20px; border-radius: 25px; text-decoration: none;
            font-weight: bold; backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            z-index: 2;
        }
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateX(-5px);
        }
        .header h1 { 
            font-size: 3em; margin-bottom: 15px; font-weight: 700; 
            display: flex; align-items: center; justify-content: center; gap: 20px;
        }
        .kol-avatar {
            width: 100px; height: 100px; border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 5px solid white;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        .kol-avatar.default {
            background: white; color: #667eea;
            display: flex; align-items: center; justify-content: center;
            font-size: 2.5em; font-weight: bold;
        }
        .subtitle { font-size: 1.3em; opacity: 0.9; margin-bottom: 30px; }
        
        .grade-section {
            display: flex; justify-content: center; align-items: center; 
            gap: 30px; margin: 30px 0; flex-wrap: wrap;
        }
        .grade-badge {
            padding: 15px 30px; 
            border-radius: 25px; 
            font-size: 2em; 
            font-weight: bold; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            color: white;
        }
        .score-display {
            font-size: 2.5em; font-weight: bold; color: white; text-align: center;
        }
        .investment-grade {
            background: rgba(255,255,255,0.15); color: white; 
            padding: 10px 20px; border-radius: 15px; font-size: 1em;
            border: 2px solid rgba(255,255,255,0.3); text-align: center;
            max-width: 150px;
        }
        .market-influence {
            background: rgba(255,255,255,0.15); color: white; 
            padding: 10px 20px; border-radius: 15px; font-size: 1em;
            border: 2px solid rgba(255,255,255,0.3); text-align: center;
            max-width: 150px;
        }
        
        .executive-summary {
            background: rgba(255,255,255,0.1); margin: 30px 0; 
            padding: 25px; border-radius: 15px; color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .section {
            padding: 50px;
        }
        .section-title {
            font-size: 2.2em; margin-bottom: 30px; color: #333; 
            border-bottom: 3px solid #667eea; padding-bottom: 15px;
        }
        
        .professional-metrics {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px; margin: 30px 0;
        }
        .metric-card {
            background: white; padding: 25px; border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.12); text-align: center;
            border-top: 4px solid #667eea;
        }
        .metric-value {
            font-size: 2.2em; font-weight: bold; color: #667eea;
            margin-bottom: 10px;
        }
        .metric-label {
            font-size: 1.1em; color: #666; font-weight: 500;
        }
        
        .competency-matrix {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px; margin: 30px 0;
        }
        .competency-card {
            background: white; padding: 25px; border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        .competency-title {
            font-size: 1.2em; font-weight: bold; margin-bottom: 15px;
            color: #333;
        }
        .competency-score {
            font-size: 2em; font-weight: bold; margin-bottom: 10px;
        }
        .score-excellent { color: #4CAF50; }
        .score-good { color: #8BC34A; }
        .score-average { color: #FF9800; }
        .score-poor { color: #F44336; }
        
        .progress-bar {
            width: 100%; height: 25px; background: #e0e0e0; 
            border-radius: 15px; overflow: hidden; margin: 10px 0;
        }
        .progress-fill {
            height: 100%; transition: width 0.8s ease;
            background: linear-gradient(90deg, #F44336 0%, #FF9800 50%, #4CAF50 100%);
        }
        
        .investment-advisory {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; padding: 40px; border-radius: 20px; margin: 30px 0;
        }
        .advisory-title {
            font-size: 1.8em; margin-bottom: 20px; font-weight: bold;
        }
        .advisory-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px; margin: 25px 0;
        }
        .advisory-card {
            background: rgba(255,255,255,0.15); padding: 25px; 
            border-radius: 15px; backdrop-filter: blur(10px);
        }
        .advisory-card h4 {
            margin-top: 0; font-size: 1.2em;
        }
        .recommendation {
            font-size: 1.1em; font-weight: bold; margin: 10px 0; color: #FFD700;
        }
        
        .strengths-weaknesses {
            display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;
        }
        .strength-card, .weakness-card {
            padding: 30px; border-radius: 15px;
        }
        .strength-card {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c8 100%);
            border-left: 6px solid #4CAF50;
        }
        .weakness-card {
            background: linear-gradient(135deg, #fff3e0 0%, #ffcc80 100%);
            border-left: 6px solid #FF9800;
        }
        .strength-card h3, .weakness-card h3 {
            margin-top: 0;
        }
        
        .tweet-example {
            background: rgba(255,255,255,0.7); padding: 15px; 
            border-radius: 10px; margin: 10px 0;
            font-style: italic; border-left: 3px solid #2196F3;
        }
        
        .coin-analysis-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 30px; margin-top: 30px;
        }
        .coin-card {
            background: white; border-radius: 20px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-top: 5px solid #667eea;
            transition: all 0.3s ease; cursor: pointer;
            position: relative;
        }
        .coin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        
        .coin-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 20px;
        }
        .coin-name {
            font-size: 1.6em; font-weight: bold; color: #333;
            display: flex; align-items: center; gap: 10px;
        }
        .coin-icon {
            width: 40px; height: 40px; border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: bold;
        }
        .coin-grade {
            padding: 6px 12px; border-radius: 15px;
            font-size: 0.9em; font-weight: bold; color: white;
        }
        
        .coin-stats {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 15px; margin: 20px 0;
        }
        .coin-stat {
            text-align: center; padding: 10px;
            background: #f8f9fa; border-radius: 10px;
        }
        .coin-stat-label {
            font-size: 0.9em; color: #666; margin-bottom: 5px;
        }
        .coin-stat-value {
            font-size: 1.3em; font-weight: bold; color: #333;
        }
        
        .analysis-summary {
            background: #e3f2fd; padding: 15px; border-radius: 10px;
            margin: 15px 0; color: #1565c0; line-height: 1.6;
        }
        
        .prediction-timeline {
            margin-top: 20px; padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .timeline-title {
            font-weight: bold; color: #666; margin-bottom: 10px;
        }
        .timeline-items {
            display: flex; flex-direction: column; gap: 10px;
        }
        .timeline-item {
            display: flex; align-items: center; gap: 10px;
            padding: 8px; background: #f8f9fa; border-radius: 8px;
            font-size: 0.9em;
        }
        .timeline-date {
            color: #666; min-width: 80px;
        }
        .timeline-accuracy {
            margin-left: auto; font-weight: bold;
        }
        .accuracy-high { color: #4CAF50; }
        .accuracy-medium { color: #FF9800; }
        .accuracy-low { color: #F44336; }
        
        .view-analysis-btn {
            display: block; background: #667eea; color: white;
            padding: 12px 25px; border-radius: 25px; text-decoration: none;
            font-weight: bold; transition: all 0.3s ease;
            margin-top: 20px; text-align: center;
        }
        .view-analysis-btn:hover {
            background: #5a6fd8; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .filter-tabs {
            display: flex; gap: 15px; margin-bottom: 30px;
            border-bottom: 2px solid #eee; padding-bottom: 15px;
        }
        .filter-tab {
            padding: 10px 20px; border-radius: 20px 20px 0 0;
            background: #f8f9fa; color: #666; cursor: pointer;
            font-weight: bold; transition: all 0.3s ease;
        }
        .filter-tab.active {
            background: #667eea; color: white;
        }
        
        @media (max-width: 768px) {
            .container { margin: 10px; }
            .section { padding: 25px; }
            .coin-analysis-grid { grid-template-columns: 1fr; }
            .header h1 { font-size: 2em; flex-direction: column; }
            .competency-matrix { grid-template-columns: 1fr; }
            .strengths-weaknesses { grid-template-columns: 1fr; }
            .grade-section { flex-direction: column; }
            .advisory-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-background" id="header-background"></div>
            <a href="../index.html" class="back-btn">â† è¿”å›KOLåˆ—è¡¨</a>
            <div class="header-content">
                <h1>
                    <div class="kol-avatar" id="kol-avatar">{kol_initials}</div>
                    @{kol_name}
                </h1>
                <div class="subtitle">ä¸“ä¸šçº§åŠ å¯†è´§å¸åˆ†æå¸ˆè¯„ä¼°æŠ¥å‘Š</div>
                
                <div class="grade-section">
                    <div class="grade-badge">{grade}çº§</div>
                    <div class="score-display">{score}åˆ†</div>
                    <div class="investment-grade">æŠ•èµ„ç­‰çº§<br>{investment_grade}</div>
                    <div class="market-influence">å¸‚åœºå½±å“åŠ›<br>{market_influence}</div>
                </div>
                
                <div class="executive-summary">
                    <h3 style="margin-top: 0;">ğŸ“‹ æ‰§è¡Œæ‘˜è¦</h3>
                    <p style="margin-bottom: 0; font-size: 1.1em; line-height: 1.7;">
                        {key_verdict}
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Professional Metrics -->
        <div class="section">
            <h2 class="section-title">ğŸ“Š ä¸“ä¸šè¡¨ç°æŒ‡æ ‡</h2>
            {professional_metrics}
        </div>
        
        <!-- Professional Competency Matrix -->
        <div class="section">
            <h2 class="section-title">ğŸ¯ ä¸“ä¸šèƒ½åŠ›çŸ©é˜µè¯„ä¼°</h2>
            {competency_matrix}
        </div>
        
        <!-- Investment Advisory -->
        <div class="section">
            <h2 class="section-title">ğŸ’¼ æŠ•èµ„å’¨è¯¢å»ºè®®</h2>
            {investment_advisory}
        </div>
        
        <!-- Strengths & Weaknesses -->
        <div class="section">
            <h2 class="section-title">ğŸ’ª ä¼˜åŠ¿ä¸æ”¹è¿›é¢†åŸŸ</h2>
            {strengths_weaknesses}
        </div>
        
        <!-- Forward Looking Assessment -->
        <div class="section">
            <h2 class="section-title">ğŸ”® å‰ç»æ€§è¯„ä¼°</h2>
            {forward_looking}
        </div>
        
        <!-- Coin Analysis -->
        <div class="section">
            <h2 class="section-title">ğŸª™ å¸ç§åˆ†æé€»è¾‘é“¾</h2>
            
            <div class="filter-tabs">
                <div class="filter-tab active" onclick="filterCoins('all')">å…¨éƒ¨å¸ç§</div>
                <div class="filter-tab" onclick="filterCoins('excellent')">ä¼˜ç§€è¡¨ç°</div>
                <div class="filter-tab" onclick="filterCoins('good')">è‰¯å¥½è¡¨ç°</div>
                <div class="filter-tab" onclick="filterCoins('poor')">è¾ƒå·®è¡¨ç°</div>
            </div>
            
            <div class="coin-analysis-grid" id="coin-grid">
                <!-- åŠ¨æ€ç”Ÿæˆå¸ç§åˆ†æå¡ç‰‡ -->
            </div>
        </div>
    </div>
    
    <script>
        // å¸ç§æ•°æ®å°†ä»åç«¯åŠ¨æ€åŠ è½½
        const coinAnalysisData = {coin_analysis_data_placeholder};
        let currentFilter = 'all';
        
        // KOL profileæ•°æ®
        let kolProfiles = {};
        
        // è·å–URLå‚æ•°
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                kol: params.get('kol') || ''
            };
        }
        
        // ğŸ”§ ä¿®å¤ï¼šåŠ è½½KOL profileæ•°æ® - ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„
        async function loadKOLProfiles() {
            try {
                // ğŸ”§ ä¿®å¤ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œä»çˆ¶ç›®å½•åŠ è½½
                const response = await fetch('../kol_list.json');
                if (response.ok) {
                    const profiles = await response.json();
                    profiles.forEach(profile => {
                        kolProfiles[profile.username.toLowerCase()] = profile;
                    });
                    updateKOLProfile();
                } else {
                    console.warn('æ— æ³•åŠ è½½KOL profileæ•°æ®: HTTP', response.status);
                }
            } catch (error) {
                console.warn('æ— æ³•åŠ è½½KOL profileæ•°æ®:', error);
            }
        }
        
        // ğŸ”§ ä¿®å¤ï¼šæ›´æ–°KOLå¤´åƒå’ŒèƒŒæ™¯ - ä½¿ç”¨æœ¬åœ°å›¾ç‰‡è·¯å¾„
        function updateKOLProfile() {
            const kolName = '{kol_name}'.toLowerCase();
            const profile = kolProfiles[kolName];
            
            if (profile) {
                // ğŸ”§ ä¿®å¤ï¼šä½¿ç”¨æœ¬åœ°èƒŒæ™¯å›¾ç‰‡è·¯å¾„
                if (profile.local_background_filename) {
                    const bgPath = `../assets/images/${profile.local_background_filename}`;
                    document.getElementById('header-background').style.backgroundImage = `url('${bgPath}')`;
                    console.log('âœ… åŠ è½½èƒŒæ™¯å›¾ç‰‡:', bgPath);
                }
                
                // ğŸ”§ ä¿®å¤ï¼šä½¿ç”¨æœ¬åœ°å¤´åƒå›¾ç‰‡è·¯å¾„
                if (profile.local_avatar_filename) {
                    const avatarPath = `../assets/images/${profile.local_avatar_filename}`;
                    const avatarEl = document.getElementById('kol-avatar');
                    avatarEl.style.backgroundImage = `url('${avatarPath}')`;
                    avatarEl.textContent = '';
                    avatarEl.classList.remove('default');
                    console.log('âœ… åŠ è½½å¤´åƒå›¾ç‰‡:', avatarPath);
                }
            } else {
                console.warn('æœªæ‰¾åˆ°KOL profile:', kolName);
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            loadKOLProfiles();
            renderCoinCards();
            initProgressBars();
        });
        
        function filterCoins(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            renderCoinCards();
        }
        
        function renderCoinCards() {
            const coinGrid = document.getElementById('coin-grid');
            let filteredData = coinAnalysisData || [];
            
            // åº”ç”¨ç­›é€‰
            if (currentFilter !== 'all') {
                filteredData = filteredData.filter(coin => {
                    const accuracy = coin.overall_accuracy || 0;
                    switch(currentFilter) {
                        case 'excellent': return accuracy >= 80;
                        case 'good': return accuracy >= 60 && accuracy < 80;
                        case 'poor': return accuracy < 60;
                        default: return true;
                    }
                });
            }
            
            // ç”Ÿæˆå¡ç‰‡HTML
            const cardsHtml = filteredData.map(coin => {
                const gradeClass = getGradeClass(coin.performance_grade || 'C');
                const accuracyClass = (coin.overall_accuracy || 0) >= 80 ? 'accuracy-high' : 
                                     (coin.overall_accuracy || 0) >= 60 ? 'accuracy-medium' : 'accuracy-low';
                
                // ç”Ÿæˆæ—¶é—´çº¿é¡¹ç›® - å®‰å…¨å¤„ç†
                const predictions = coin.predictions || [];
                const timelineHtml = predictions.slice(0, 3).map(pred => `
                    <div class="timeline-item">
                        <span class="timeline-date">${pred.date || 'N/A'}</span>
                        <span>${pred.type || 'N/A'} - ${pred.sentiment || 'N/A'}</span>
                        <span class="timeline-accuracy ${(pred.accuracy || 0) >= 80 ? 'accuracy-high' : 
                                                       (pred.accuracy || 0) >= 60 ? 'accuracy-medium' : 'accuracy-low'}">
                            ${(pred.accuracy || 0).toFixed(0)}%
                        </span>
                    </div>
                `).join('');
                
                return `
                    <div class="coin-card" onclick="viewCoinAnalysis('${coin.coin_id || ''}')">
                        <div class="coin-header">
                            <div class="coin-name">
                                <div class="coin-icon">${(coin.coin_name || 'N/A').substring(0, 2).toUpperCase()}</div>
                                ${coin.coin_name || 'Unknown Coin'}
                            </div>
                            <div class="coin-grade grade-${gradeClass}">${coin.performance_grade || 'C'}</div>
                        </div>
                        
                        <div class="coin-stats">
                            <div class="coin-stat">
                                <div class="coin-stat-label">æ•´ä½“å‡†ç¡®ç‡</div>
                                <div class="coin-stat-value ${accuracyClass}">
                                    ${(coin.overall_accuracy || 0).toFixed(1)}%
                                </div>
                            </div>
                            <div class="coin-stat">
                                <div class="coin-stat-label">é¢„æµ‹æ•°é‡</div>
                                <div class="coin-stat-value">${coin.total_predictions || 0}</div>
                            </div>
                            <div class="coin-stat">
                                <div class="coin-stat-label">çŸ­æœŸè¡¨ç°</div>
                                <div class="coin-stat-value">${(coin.short_term_accuracy || 0).toFixed(1)}%</div>
                            </div>
                            <div class="coin-stat">
                                <div class="coin-stat-label">é•¿æœŸè¡¨ç°</div>
                                <div class="coin-stat-value">${(coin.long_term_accuracy || 0).toFixed(1)}%</div>
                            </div>
                        </div>
                        
                        <div class="analysis-summary">
                            ${coin.summary || 'æš‚æ— åˆ†ææ‘˜è¦'}
                        </div>
                        
                        <div class="prediction-timeline">
                            <div class="timeline-title">è¿‘æœŸé¢„æµ‹è¡¨ç°</div>
                            <div class="timeline-items">
                                ${timelineHtml}
                            </div>
                            ${predictions.length > 3 ? 
                                `<div style="text-align: center; margin-top: 10px; color: #666; font-size: 0.9em;">
                                    è¿˜æœ‰ ${predictions.length - 3} ä¸ªé¢„æµ‹...
                                </div>` : ''}
                        </div>
                        
                        <a href="#" class="view-analysis-btn">æŸ¥çœ‹è¯¦ç»†æ¨ç†é“¾ â†’</a>
                    </div>
                `;
            }).join('');
            
            coinGrid.innerHTML = cardsHtml || '<div style="text-align: center; color: #666; padding: 50px;">æš‚æ— ç¬¦åˆæ¡ä»¶çš„å¸ç§åˆ†æ</div>';
        }
        
        function getGradeClass(grade) {
            return (grade || 'C').replace(/\+/g, '\\\\+').replace(/-/g, '_');
        }
        
        function viewCoinAnalysis(coinId) {
            if (!coinId) return;
            // è·³è½¬åˆ°å…·ä½“å¸ç§çš„è¯¦ç»†åˆ†æé¡µé¢
            const kolName = '{kol_name}';
            window.location.href = `../coin_reports/${kolName}_${coinId}_analysis.html`;
        }
        
        function initProgressBars() {
            document.querySelectorAll('.progress-fill').forEach(bar => {
                const width = bar.getAttribute('data-width');
                if (width) {
                    setTimeout(() => { bar.style.width = width + '%'; }, 500);
                }
            });
        }
    </script>
</body>
</html>