<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸“ä¸šçº§KOLåˆ†æç³»ç»Ÿ - KOLåˆ—è¡¨</title>
    <style>
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6; margin: 0; padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; color: #333;
        }
        .container {
            max-width: 1600px; margin: 0 auto; background: white;
            border-radius: 20px; box-shadow: 0 15px 50px rgba(0,0,0,0.25);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; padding: 50px; text-align: center;
        }
        .header h1 { font-size: 3.5em; margin-bottom: 15px; font-weight: 700; }
        .subtitle { font-size: 1.5em; opacity: 0.9; margin-bottom: 30px; }
        
        .summary-stats {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px; margin: 30px 0; padding: 0 20px;
        }
        .stat-card {
            background: rgba(255,255,255,0.15); padding: 25px; border-radius: 15px;
            text-align: center; backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .stat-value {
            font-size: 2.5em; font-weight: bold; color: white; margin-bottom: 10px;
        }
        .stat-label {
            font-size: 1.1em; color: rgba(255,255,255,0.8);
        }
        
        .section {
            padding: 50px;
        }
        .section-title {
            font-size: 2.2em; margin-bottom: 30px; color: #333; 
            border-bottom: 3px solid #667eea; padding-bottom: 15px;
        }
        
        .grade-distribution {
            display: flex; justify-content: center; flex-wrap: wrap;
            gap: 20px; margin: 30px 0;
        }
        .grade-item {
            text-align: center; min-width: 80px;
        }
        .grade-badge {
            width: 60px; height: 60px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 1.5em;
            font-weight: bold; margin: 0 auto 10px; color: white;
        }
        .grade-S { background: #1B5E20; }
        .grade-A\+ { background: #2E7D32; }
        .grade-A { background: #4CAF50; }
        .grade-A_ { background: #66BB6A; }
        .grade-B\+ { background: #8BC34A; color: black; }
        .grade-B { background: #CDDC39; color: black; }
        .grade-B_ { background: #FFEB3B; color: black; }
        .grade-C\+ { background: #FF9800; }
        .grade-C { background: #FF5722; }
        .grade-C_ { background: #F44336; }
        .grade-D\+ { background: #E91E63; }
        .grade-D { background: #9C27B0; }
        .grade-F { background: #673AB7; }
        
        .kol-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));
            gap: 30px; margin-top: 30px;
        }
        
        .kol-card {
            background: white; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-left: 6px solid #667eea; position: relative;
            transition: all 0.3s ease; cursor: pointer;
            overflow: hidden;
        }
        .kol-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        
        /* KOL Profile Background */
        .kol-card-background {
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 120px;
            background-size: cover;
            background-position: center;
            opacity: 0.9;
            z-index: 1;
        }
        
        .kol-card-content {
            position: relative;
            z-index: 2;
            padding: 30px;
            padding-top: 80px;
        }
        
        .kol-rank {
            position: absolute; top: 20px; right: 20px;
            background: rgba(255,255,255,0.9); color: #667eea; 
            padding: 5px 15px;
            border-radius: 20px; font-weight: bold;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 3;
        }
        
        .kol-header {
            display: flex; align-items: center; gap: 20px; margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .kol-avatar {
            width: 80px; height: 80px; border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 4px solid white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            margin-top: -40px;
        }
        .kol-avatar.default {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; align-items: center; justify-content: center;
            color: white; font-size: 2em; font-weight: bold;
        }
        .kol-name {
            font-size: 1.6em; font-weight: bold; color: #333;
            text-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .kol-grade {
            padding: 8px 16px; border-radius: 20px; color: white; font-weight: bold;
        }
        .kol-score {
            font-size: 1.3em; font-weight: bold; color: #667eea;
        }
        .kol-investment-grade {
            background: #f8f9fa; padding: 6px 12px; border-radius: 15px;
            font-size: 0.9em; color: #666; border: 1px solid #ddd;
        }
        
        .kol-stats {
            display: grid; grid-template-columns: repeat(3, 1fr);
            gap: 15px; margin: 20px 0;
        }
        .stat {
            text-align: center; padding: 10px;
            background: #f8f9fa; border-radius: 10px;
        }
        .stat-label {
            font-size: 0.9em; color: #666; margin-bottom: 5px;
        }
        .stat-value {
            font-size: 1.2em; font-weight: bold; color: #333;
        }
        
        .kol-summary {
            background: #e3f2fd; padding: 15px; border-radius: 10px;
            margin: 15px 0; color: #1565c0; line-height: 1.6;
            font-size: 0.95em;
        }
        
        .kol-coins {
            margin-top: 20px;
        }
        .coin-list {
            display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;
        }
        .coin-tag {
            background: #667eea; color: white; padding: 5px 12px;
            border-radius: 15px; font-size: 0.9em;
        }
        
        .view-details-btn {
            display: inline-block; background: #667eea; color: white;
            padding: 12px 25px; border-radius: 25px; text-decoration: none;
            font-weight: bold; transition: all 0.3s ease;
            margin-top: 20px; width: 100%; text-align: center;
        }
        .view-details-btn:hover {
            background: #5a6fd8; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .filter-section {
            background: #f8f9fa; padding: 30px; border-radius: 20px;
            margin-bottom: 30px;
        }
        .filter-title {
            font-size: 1.3em; font-weight: bold; margin-bottom: 20px;
        }
        .filter-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        .filter-group {
            display: flex; flex-direction: column; gap: 10px;
        }
        .filter-label {
            font-weight: bold; color: #666;
        }
        .filter-select {
            padding: 10px; border-radius: 10px; border: 1px solid #ddd;
            font-size: 1em;
        }
        
        @media (max-width: 768px) {
            .container { margin: 10px; }
            .section { padding: 25px; }
            .kol-grid { grid-template-columns: 1fr; }
            .header h1 { font-size: 2.5em; }
            .summary-stats { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† ä¸“ä¸šçº§KOLåˆ†æç³»ç»Ÿ</h1>
            <div class="subtitle">åŸºäºçœŸå®å†å²ä»·æ ¼éªŒè¯å’Œæ·±åº¦åˆ†æçš„ç»¼åˆè¯„ä¼°</div>
            
            <div class="summary-stats">
                <div class="stat-card">
                    <div class="stat-value" id="total-kols">0</div>
                    <div class="stat-label">åˆ†æKOLæ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avg-score">0</div>
                    <div class="stat-label">å¹³å‡è¯„åˆ†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avg-accuracy">0%</div>
                    <div class="stat-label">å¹³å‡å‡†ç¡®ç‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="excellent-kols">0</div>
                    <div class="stat-label">ä¼˜ç§€KOL (S/Açº§)</div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2 class="section-title">ğŸ“Š ä¸“ä¸šè¯„çº§åˆ†å¸ƒ</h2>
            <div class="grade-distribution" id="grade-distribution">
                <!-- åŠ¨æ€ç”Ÿæˆè¯„çº§åˆ†å¸ƒ -->
            </div>
        </div>
        
        <div class="section">
            <h2 class="section-title">ğŸ” ç­›é€‰å’Œæ’åº</h2>
            <div class="filter-section">
                <div class="filter-grid">
                    <div class="filter-group">
                        <label class="filter-label">è¯„çº§ç­›é€‰</label>
                        <select class="filter-select" id="grade-filter">
                            <option value="">æ‰€æœ‰è¯„çº§</option>
                            <option value="S,A+,A,A-">ä¼˜ç§€ (S-Açº§)</option>
                            <option value="B+,B,B-">è‰¯å¥½ (Bçº§)</option>
                            <option value="C+,C,C-">ä¸€èˆ¬ (Cçº§)</option>
                            <option value="D+,D,F">è¾ƒå·® (D-Fçº§)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">æŠ•èµ„ç­‰çº§</label>
                        <select class="filter-select" id="investment-filter">
                            <option value="">æ‰€æœ‰ç­‰çº§</option>
                            <option value="INSTITUTIONAL">æœºæ„çº§</option>
                            <option value="PROFESSIONAL">ä¸“ä¸šçº§</option>
                            <option value="RETAIL">æ•£æˆ·çº§</option>
                            <option value="CAUTIOUS">è°¨æ…çº§</option>
                            <option value="AVOID">é¿å…çº§</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">æ’åºæ–¹å¼</label>
                        <select class="filter-select" id="sort-filter">
                            <option value="score">æŒ‰è¯„åˆ†æ’åº</option>
                            <option value="accuracy">æŒ‰å‡†ç¡®ç‡æ’åº</option>
                            <option value="name">æŒ‰åç§°æ’åº</option>
                            <option value="coins">æŒ‰å¸ç§æ•°é‡æ’åº</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2 class="section-title">ğŸ‘¥ KOLä¸“ä¸šæ’è¡Œæ¦œ</h2>
            <div class="kol-grid" id="kol-grid">
                <!-- åŠ¨æ€ç”ŸæˆKOLå¡ç‰‡ -->
            </div>
        </div>
    </div>
    
    <script>
        // KOLæ•°æ®å°†ä»åç«¯åŠ¨æ€åŠ è½½
        const kolData = {kol_data_placeholder};
        
        // KOL profileæ•°æ®
        let kolProfiles = {};
        
        // åŠ è½½KOL profileæ•°æ®
        async function loadKOLProfiles() {
            try {
                const response = await fetch('./kol_list.json');
                if (response.ok) {
                    const profiles = await response.json();
                    profiles.forEach(profile => {
                        kolProfiles[profile.username.toLowerCase()] = profile;
                    });
                }
            } catch (error) {
                console.warn('æ— æ³•åŠ è½½KOL profileæ•°æ®:', error);
            }
        }
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', async () => {
            await loadKOLProfiles();
            updateSummaryStats();
            updateGradeDistribution();
            renderKOLCards();
            setupFilters();
        });
        
        function updateSummaryStats() {
            // è®¡ç®—æ±‡æ€»ç»Ÿè®¡æ•°æ®
            const totalKOLs = Object.keys(kolData).length;
            let totalScore = 0;
            let totalAccuracy = 0;
            let excellentCount = 0;

            Object.values(kolData).forEach(kol => {
                totalScore += kol.overall_score || 0;
                totalAccuracy += kol.overall_accuracy || 0;
                // ä¼˜å…ˆä½¿ç”¨tierï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨overall_grade
                const grade = kol.tier || kol.overall_grade || 'C';
                if (['S+', 'S', 'S-', 'A+', 'A', 'A-'].includes(grade)) {
                    excellentCount++;
                }
            });

            document.getElementById('total-kols').textContent = totalKOLs;
            document.getElementById('avg-score').textContent = totalKOLs > 0 ?
                (totalScore / totalKOLs).toFixed(1) : '0';
            document.getElementById('avg-accuracy').textContent = totalKOLs > 0 ?
                (totalAccuracy / totalKOLs).toFixed(1) + '%' : '0%';
            document.getElementById('excellent-kols').textContent = excellentCount;
        }
        
        function updateGradeDistribution() {
            const gradeCounts = {};
            Object.values(kolData).forEach(kol => {
                const grade = kol.overall_grade || 'C';
                gradeCounts[grade] = (gradeCounts[grade] || 0) + 1;
            });
            
            const gradeOrder = ['S', 'A+', 'A', 'A-', 'B+', 'B', 'B-', 'C+', 'C', 'C-', 'D+', 'D', 'F'];
            const distributionHtml = gradeOrder.map(grade => {
                const count = gradeCounts[grade] || 0;
                if (count === 0) return '';
                
                const gradeClass = grade.replace('+', '\\+').replace('-', '_');
                return `
                    <div class="grade-item">
                        <div class="grade-badge grade-${gradeClass}">${grade}</div>
                        <div style="font-weight: bold;">${count}</div>
                        <div style="color: #666; font-size: 0.9em;">
                            (${((count / Object.keys(kolData).length) * 100).toFixed(1)}%)
                        </div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('grade-distribution').innerHTML = distributionHtml;
        }
        
        function renderKOLCards(filteredData = null) {
            const data = filteredData || kolData;
            const kolGrid = document.getElementById('kol-grid');
            
            // è½¬æ¢ä¸ºæ•°ç»„å¹¶æ’åº
            const kolArray = Object.entries(data).map(([kolId, kol]) => ({
                id: kolId,
                ...kol
            }));
            
            // é»˜è®¤æŒ‰è¯„åˆ†æ’åº
            kolArray.sort((a, b) => (b.overall_score || 0) - (a.overall_score || 0));
            
            const cardsHtml = kolArray.map((kol, index) => {
                const gradeClass = (kol.overall_grade || 'C').replace('+', '\\+').replace('-', '_');
                const initials = kol.name ? kol.name.substring(0, 2).toUpperCase() : 'KOL';
                
                // è·å–KOL profile
                const profile = kolProfiles[kol.name?.toLowerCase()];
                const backgroundStyle = profile?.background ? 
                    `background-image: url('${profile.background}');` : 
                    'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);';
                
                const avatarHtml = profile?.avatar ? 
                    `<div class="kol-avatar" style="background-image: url('${profile.avatar}');"></div>` :
                    `<div class="kol-avatar default">${initials}</div>`;
                
                // è·å–åˆ†æçš„å¸ç§åˆ—è¡¨
                const coins = kol.analyzed_coins || [];
                const coinsHtml = coins.slice(0, 5).map(coin => 
                    `<span class="coin-tag">${coin}</span>`
                ).join('');
                const moreCoins = coins.length > 5 ? `<span class="coin-tag">+${coins.length - 5} more</span>` : '';
                
                return `
                    <div class="kol-card" onclick="viewKOLDetails('${kol.id}')">
                        <div class="kol-card-background" style="${backgroundStyle}"></div>
                        <div class="kol-rank">#${index + 1}</div>
                        <div class="kol-card-content">
                            <div class="kol-header">
                                ${avatarHtml}
                                <div style="flex: 1;">
                                    <div class="kol-name">@${kol.name}</div>
                                    <div style="display: flex; gap: 10px; margin-top: 8px; flex-wrap: wrap;">
                                        <div class="kol-grade grade-${gradeClass}">${kol.overall_grade || 'C'}çº§</div>
                                        <div class="kol-score">${kol.overall_score || 60}åˆ†</div>
                                        <div class="kol-investment-grade">${kol.investment_grade || 'CAUTIOUS'}</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="kol-stats">
                                <div class="stat">
                                    <div class="stat-label">æ•´ä½“å‡†ç¡®ç‡</div>
                                    <div class="stat-value">${(kol.overall_accuracy || 0).toFixed(1)}%</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">çŸ­æœŸè¡¨ç°</div>
                                    <div class="stat-value">${(kol.short_term_accuracy || 0).toFixed(1)}%</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">é•¿æœŸè¡¨ç°</div>
                                    <div class="stat-value">${(kol.long_term_accuracy || 0).toFixed(1)}%</div>
                                </div>
                            </div>
                            
                            <div class="kol-summary">
                                ${kol.key_verdict || 'ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†åˆ†ææŠ¥å‘Š'}
                            </div>
                            
                            <div class="kol-coins">
                                <div style="font-weight: bold; color: #666;">åˆ†æå¸ç§ (${coins.length})</div>
                                <div class="coin-list">
                                    ${coinsHtml}
                                    ${moreCoins}
                                </div>
                            </div>
                            
                            <a href="#" class="view-details-btn">æŸ¥çœ‹è¯¦ç»†åˆ†æ â†’</a>
                        </div>
                    </div>
                `;
            }).join('');
            
            kolGrid.innerHTML = cardsHtml;
        }
        
        function setupFilters() {
            const gradeFilter = document.getElementById('grade-filter');
            const investmentFilter = document.getElementById('investment-filter');
            const sortFilter = document.getElementById('sort-filter');
            
            const applyFilters = () => {
                let filteredData = {...kolData};
                
                // åº”ç”¨è¯„çº§ç­›é€‰
                const gradeValue = gradeFilter.value;
                if (gradeValue) {
                    const allowedGrades = gradeValue.split(',');
                    filteredData = Object.fromEntries(
                        Object.entries(filteredData).filter(([_, kol]) => 
                            allowedGrades.includes(kol.overall_grade || 'C')
                        )
                    );
                }
                
                // åº”ç”¨æŠ•èµ„ç­‰çº§ç­›é€‰
                const investmentValue = investmentFilter.value;
                if (investmentValue) {
                    filteredData = Object.fromEntries(
                        Object.entries(filteredData).filter(([_, kol]) => 
                            kol.investment_grade === investmentValue
                        )
                    );
                }
                
                renderKOLCards(filteredData);
            };
            
            gradeFilter.addEventListener('change', applyFilters);
            investmentFilter.addEventListener('change', applyFilters);
            sortFilter.addEventListener('change', applyFilters);
        }
        
        function viewKOLDetails(kolId) {
            // è·³è½¬åˆ°KOLå¸ç§åˆ—è¡¨é¡µé¢
            window.location.href = `./kol_reports/${kolId}_analysis.html`;
        }
    </script>
</body>
</html>